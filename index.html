<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∞—Ö–º–∞—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –¥—Ä—É–∑–µ–π</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üèÜ –®–∞—Ö–º–∞—Ç–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä –¥—Ä—É–∑–µ–π</h1>
        <p>–†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å Lichess.org</p>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="rating" onclick="switchTab('rating')">üìä –†–µ–π—Ç–∏–Ω–≥</button>
            <button class="tab-btn" data-tab="history" onclick="switchTab('history')">‚öîÔ∏è –ò—Å—Ç–æ—Ä–∏—è –ø–∞—Ä—Ç–∏–π –º–µ–∂–¥—É –Ω–∞–º–∏</button>
            <button class="tab-btn" data-tab="chat" onclick="switchTab('chat')">üí¨ –ß–∞—Ç</button>
        </div>

        <!-- ‚îÄ‚îÄ –í–ö–õ–ê–î–ö–ê: –†–ï–ô–¢–ò–ù–ì ‚îÄ‚îÄ -->
        <div id="tab-rating" class="tab-content active">
            <div class="controls">
                <button onclick="location.reload()" class="refresh-btn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>

            <table class="leaderboard">
                <thead>
                    <tr>
                        <th>–ú–µ—Å—Ç–æ</th>
                        <th>–ò–≥—Ä–æ–∫</th>
                        <th class="sortable" onclick="sortTable('rapid')">–†–∞–ø–∏–¥ ‚¨ç</th>
                        <th class="sortable" onclick="sortTable('blitz')">–ë–ª–∏—Ü ‚¨ç</th>
                        <th class="sortable" onclick="sortTable('bullet')">–ü—É–ª—è ‚¨ç</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <tr><td colspan="5" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td></tr>
                </tbody>
            </table>

            <div class="add-player">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</h3>
                <input type="text" id="new-username" placeholder="–ù–∏–∫–Ω–µ–π–º –Ω–∞ Lichess">
                <button onclick="addPlayer()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ –í–ö–õ–ê–î–ö–ê: –ò–°–¢–û–†–ò–Ø –ü–ê–†–¢–ò–ô ‚îÄ‚îÄ -->
        <div id="tab-history" class="tab-content">
            <div class="controls">
                <button onclick="loadGamesHistory()" class="refresh-btn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
            </div>
            <div id="games-list">
                <p class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ –í–ö–õ–ê–î–ö–ê: –ß–ê–¢ ‚îÄ‚îÄ -->
        <div id="tab-chat" class="tab-content">
            <div class="chat-wrapper">
                <div class="chat-header">
                    <span class="chat-title">üí¨ –û–±—â–∏–π —á–∞—Ç</span>
                    <button class="chat-nick-btn" onclick="changeNickname()">
                        üë§ <span id="chat-current-nick">‚Äî</span> <span class="chat-nick-edit">‚úèÔ∏è</span>
                    </button>
                </div>
                <div id="chat-messages" class="chat-messages"></div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" class="chat-input"
                           placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ‚Ä¶" maxlength="500"
                           onkeydown="if(event.key==='Enter'&&!event.shiftKey){sendChatMessage();event.preventDefault();}">
                    <button class="chat-send-btn" onclick="sendChatMessage()">‚û§</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–´–ë–û–†–ê –ù–ò–ö–ê ‚îÄ‚îÄ -->
    <div id="nickname-modal" class="modal-overlay" style="display:none;">
        <div class="modal-box">
            <div class="modal-chess-icon">‚ôü</div>
            <h2 class="modal-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p class="modal-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –Ω–∏–∫ –¥–ª—è —á–∞—Ç–∞</p>
            <div class="nick-section-label">–ò–≥—Ä–æ–∫–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π:</div>
            <div id="nick-friends-grid" class="nick-friends-grid"></div>
            <div class="nick-divider"><span>–∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π</span></div>
            <div class="nick-custom-row">
                <input type="text" id="nick-custom-input" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º‚Ä¶"
                       maxlength="20" onkeydown="if(event.key==='Enter')confirmNickname()">
                <button class="nick-confirm-btn" onclick="confirmNickname()">–í–æ–π—Ç–∏ ‚û§</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>